#version 110

void main(void) {
 gl_Position     = gl_ModelViewProjectionMatrix * gl_Vertex;
 gl_FrontColor   = gl_Color;
 gl_TexCoord[0]  = gl_MultiTexCoord0;
}

%% -- FRAG

#version 110

uniform sampler2D tex;
uniform vec2 blur_orig; // center
uniform vec2 fix_orig;
uniform float blur_rad;  // radius of zoom effect
uniform float rad;
uniform float ratio; // texture h/w

void main(void) {
	vec2 pos = vec2(gl_TexCoord[0]);
	pos -= blur_orig;
	
	vec2 pos1 = pos;
	pos1.y *= ratio;
	
	if(length(pos1) < blur_rad)
		pos *= length(pos1)/blur_rad;
		
	gl_FragColor = texture2D(tex, pos + blur_orig);
	
	pos1 = vec2(gl_TexCoord[0]) - fix_orig;
	pos1.y *= ratio;
	
	if(length(pos1) < rad)
		gl_FragColor *= pow(vec4(0.1,0.2,0.3,1),vec4(3.0*(rad - length(pos1))));
}